# ğŸ“Š à¸£à¸²à¸¢à¸‡à¸²à¸™à¸à¸²à¸£à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œà¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸£à¸°à¸šà¸š Sarabun PDF Generator

**à¸§à¸±à¸™à¸—à¸µà¹ˆà¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ:** 14 à¸¡à¸à¸£à¸²à¸„à¸¡ 2569 (2026)  
**à¸£à¸°à¸šà¸š:** Sarabun PDF API  
**à¹€à¸—à¸„à¹‚à¸™à¹‚à¸¥à¸¢à¸µ:** Java 17 + Spring Boot 3.x + Apache PDFBox  
**à¹à¸›à¸¥à¸‡à¸¡à¸²à¸ˆà¸²à¸:** .NET + iText7

---

## ğŸ“‹ à¸ªà¸²à¸£à¸šà¸±à¸

1. [à¸ à¸²à¸à¸£à¸§à¸¡à¸£à¸°à¸šà¸š](#1-à¸ à¸²à¸à¸£à¸§à¸¡à¸£à¸°à¸šà¸š)
2. [Data Flow - à¸à¸²à¸£à¹„à¸«à¸¥à¸‚à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥](#2-data-flow---à¸à¸²à¸£à¹„à¸«à¸¥à¸‚à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥)
3. [à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡ Architecture](#3-à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡-architecture)
4. [à¸‚à¹‰à¸­à¸”à¸µ (Strengths)](#4-à¸‚à¹‰à¸­à¸”à¸µ-strengths)
5. [à¸‚à¹‰à¸­à¹€à¸ªà¸µà¸¢ (Weaknesses)](#5-à¸‚à¹‰à¸­à¹€à¸ªà¸µà¸¢-weaknesses)
6. [à¸Šà¹ˆà¸­à¸‡à¹‚à¸«à¸§à¹ˆà¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡ (Vulnerabilities)](#6-à¸Šà¹ˆà¸­à¸‡à¹‚à¸«à¸§à¹ˆà¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡-vulnerabilities)
7. [à¸›à¸±à¸à¸«à¸²à¸—à¸µà¹ˆà¸­à¸²à¸ˆà¸à¸šà¹ƒà¸™à¸à¸²à¸£à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸­à¸à¸ªà¸²à¸£](#7-à¸›à¸±à¸à¸«à¸²à¸—à¸µà¹ˆà¸­à¸²à¸ˆà¸à¸šà¹ƒà¸™à¸à¸²à¸£à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸­à¸à¸ªà¸²à¸£)
8. [à¸‚à¹‰à¸­à¹€à¸ªà¸™à¸­à¹à¸™à¸°à¸à¸²à¸£à¸à¸±à¸’à¸™à¸²](#8-à¸‚à¹‰à¸­à¹€à¸ªà¸™à¸­à¹à¸™à¸°à¸à¸²à¸£à¸à¸±à¸’à¸™à¸²)
9. [à¹à¸œà¸™à¸à¸²à¸£à¸”à¸¹à¹à¸¥à¸£à¸±à¸à¸©à¸²](#9-à¹à¸œà¸™à¸à¸²à¸£à¸”à¸¹à¹à¸¥à¸£à¸±à¸à¸©à¸²)

---

## 1. à¸ à¸²à¸à¸£à¸§à¸¡à¸£à¸°à¸šà¸š

### ğŸ¯ à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ

à¸£à¸°à¸šà¸šà¸ªà¸£à¹‰à¸²à¸‡à¹€à¸­à¸à¸ªà¸²à¸£ PDF à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸£à¸²à¸Šà¸à¸²à¸£ 9 à¸›à¸£à¸°à¹€à¸ à¸—:

| à¸£à¸«à¸±à¸ª (UUID)                            | à¸›à¸£à¸°à¹€à¸ à¸—       | à¸Šà¸·à¹ˆà¸­à¹„à¸—à¸¢              |
| -------------------------------------- | ------------ | -------------------- |
| `BB4A2F11-722D-449A-BCC5-22208C7A4DEC` | MEMO         | à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡        |
| `90F72F0E-528D-4992-907A-F2C6B37AD9A5` | OUTBOUND     | à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸ªà¹ˆà¸‡à¸­à¸­à¸        |
| `03241AA7-0E85-4C5C-A2CC-688212A79B84` | INBOUND      | à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸£à¸±à¸šà¹€à¸‚à¹‰à¸²       |
| `50792880-F85A-4343-9672-7B61AF828A5B` | REGULATION   | à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸£à¸°à¹€à¸šà¸µà¸¢à¸š       |
| `23065068-BB18-49EA-8CE7-22945E16CB6D` | ANNOUNCEMENT | à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸›à¸£à¸°à¸à¸²à¸¨        |
| `3FEDE42B-078A-4D2C-9B21-3EAD3E418F3D` | ORDER        | à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸„à¸³à¸ªà¸±à¹ˆà¸‡        |
| `AF3E7697-6F7E-4AD8-B76C-E2134DB98747` | STAMP        | à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸›à¸£à¸°à¸—à¸±à¸šà¸•à¸£à¸²     |
| `4B3EB169-6203-4A71-A3BD-A442FEAAA91F` | MINISTRY     | à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸ à¸²à¸¢à¹ƒà¸•à¹‰à¸à¸£à¸°à¸—à¸£à¸§à¸‡ |
| `4AB1EC00-9E5E-4113-B577-D8ED46BA7728` | RULE         | à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸‚à¹‰à¸­à¸šà¸±à¸‡à¸„à¸±à¸š     |

### ğŸ“ à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ

```
src/main/java/th/go/etda/sarabun/pdf/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ SecurityConfig.java         # âš ï¸ à¸›à¸´à¸” Auth (development)
â”œâ”€â”€ constant/
â”‚   â”œâ”€â”€ BookType.java               # Enum à¸›à¸£à¸°à¹€à¸ à¸—à¹€à¸­à¸à¸ªà¸²à¸£
â”‚   â””â”€â”€ SignBoxType.java            # à¸›à¸£à¸°à¹€à¸ à¸—à¸Šà¹ˆà¸­à¸‡à¸¥à¸‡à¸™à¸²à¸¡
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ GeneratePdfController.java  # REST API endpoints
â”œâ”€â”€ model/
â”‚   â”œâ”€â”€ ApiResponse.java            # Response wrapper
â”‚   â”œâ”€â”€ GeneratePdfRequest.java     # Request model (349 lines!)
â”‚   â””â”€â”€ PdfResult.java              # PDF output model
â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ GeneratePdfService.java     # Main service
â”‚   â”œâ”€â”€ UtilityService.java         # Utilities
â”‚   â””â”€â”€ pdf/
â”‚       â”œâ”€â”€ PdfGeneratorBase.java   # Base class (1,774 lines!)
â”‚       â”œâ”€â”€ PdfGeneratorFactory.java # Factory pattern
â”‚       â”œâ”€â”€ HtmlContentRenderer.java # HTML â†’ PDF
â”‚       â”œâ”€â”€ TableRenderer.java       # Table rendering
â”‚       â”œâ”€â”€ MemoPdfGenerator.java    # à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡
â”‚       â”œâ”€â”€ OutboundPdfGenerator.java # à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸ªà¹ˆà¸‡à¸­à¸­à¸
â”‚       â”œâ”€â”€ InboundPdfGenerator.java  # à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸£à¸±à¸šà¹€à¸‚à¹‰à¸²
â”‚       â””â”€â”€ ... (Generators à¸­à¸·à¹ˆà¸™à¹†)
â””â”€â”€ util/
    â””â”€â”€ HtmlUtils.java              # HTML utilities
```

---

## 2. Data Flow - à¸à¸²à¸£à¹„à¸«à¸¥à¸‚à¸­à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥

### ğŸ”„ à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™à¸«à¸¥à¸±à¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ“¥ HTTP Request                                    â”‚
â”‚   POST /api/pdf/preview                                                     â”‚
â”‚   Content-Type: application/json                                            â”‚
â”‚   Body: GeneratePdfRequest (JSON)                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ® GeneratePdfController                              â”‚
â”‚   1. à¸£à¸±à¸š Request JSON                                                       â”‚
â”‚   2. Log request info                                                       â”‚
â”‚   3. à¹€à¸£à¸µà¸¢à¸ generatePdfService.previewPdf(request)                          â”‚
â”‚   4. à¸ªà¹ˆà¸‡à¸à¸¥à¸±à¸š ApiResponse<String> (PDF Base64)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ“‹ GeneratePdfService                                 â”‚
â”‚   1. à¸­à¹ˆà¸²à¸™ bookNameId à¸ˆà¸²à¸ request                                           â”‚
â”‚   2. à¹à¸›à¸¥à¸‡ bookNameId â†’ BookType (enum)                                     â”‚
â”‚   3. à¸”à¸¶à¸‡ Generator à¸ˆà¸²à¸ PdfGeneratorFactory                                 â”‚
â”‚   4. à¹€à¸£à¸µà¸¢à¸ generator.generate(request)                                     â”‚
â”‚   5. à¹€à¸à¸´à¹ˆà¸¡à¸¥à¸²à¸¢à¹€à¸‹à¹‡à¸™ (à¸–à¹‰à¸²à¸¡à¸µ)                                                   â”‚
â”‚   6. à¸£à¸§à¸¡ PDF (merge)                                                        â”‚
â”‚   7. à¹à¸›à¸¥à¸‡à¹€à¸›à¹‡à¸™ Base64                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸ­ PdfGeneratorFactory                                â”‚
â”‚   à¹ƒà¸Šà¹‰ Strategy Pattern:                                                     â”‚
â”‚   - Map<BookType, PdfGeneratorBase> = { MEMO â†’ MemoPdfGenerator, ... }     â”‚
â”‚   - getGenerator(bookType) â†’ return generatorMap.get(bookType)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸ“„ Specific Generator (à¹€à¸Šà¹ˆà¸™ MemoPdfGenerator)             â”‚
â”‚                                                                             â”‚
â”‚   generate(request):                                                        â”‚
â”‚   1. à¸­à¹ˆà¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ documentMain/documentSub                                â”‚
â”‚   2. à¸ªà¸£à¹‰à¸²à¸‡ PDDocument (PDFBox)                                             â”‚
â”‚   3. à¹‚à¸«à¸¥à¸”à¸Ÿà¸­à¸™à¸•à¹Œ THSarabun                                                   â”‚
â”‚   4. à¸§à¸²à¸” Logo                                                               â”‚
â”‚   5. à¸§à¸²à¸” Header fields (à¸ªà¹ˆà¸§à¸™à¸£à¸²à¸Šà¸à¸²à¸£, à¸—à¸µà¹ˆ, à¸§à¸±à¸™à¸—à¸µà¹ˆ, à¹€à¸£à¸·à¹ˆà¸­à¸‡, à¹€à¸£à¸µà¸¢à¸™)              â”‚
â”‚   6. à¸§à¸²à¸”à¹€à¸™à¸·à¹‰à¸­à¸«à¸² (text à¸«à¸£à¸·à¸­ HTML)                                           â”‚
â”‚      - à¸–à¹‰à¸² HTML â†’ à¹ƒà¸Šà¹‰ HtmlContentRenderer                                  â”‚
â”‚      - à¸–à¹‰à¸² text â†’ à¹ƒà¸Šà¹‰ drawMultilineText()                                  â”‚
â”‚   7. à¸§à¸²à¸”à¸Šà¹ˆà¸­à¸‡à¸¥à¸‡à¸™à¸²à¸¡ (signatureBox)                                           â”‚
â”‚   8. à¸ˆà¸±à¸”à¸à¸²à¸£ multi-page (à¸–à¹‰à¸²à¹€à¸à¸´à¸™à¸«à¸™à¹‰à¸²)                                       â”‚
â”‚   9. à¹à¸›à¸¥à¸‡à¹€à¸›à¹‡à¸™ Base64 à¹à¸¥à¸° return                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ“¤ HTTP Response                                   â”‚
â”‚   {                                                                         â”‚
â”‚     "isOK": true,                                                          â”‚
â”‚     "statusCode": 200,                                                     â”‚
â”‚     "message": "à¸ªà¸£à¹‰à¸²à¸‡ PDF à¸ªà¸³à¹€à¸£à¹‡à¸ˆ",                                         â”‚
â”‚     "data": "JVBERi0xLjQKJd..." (Base64 PDF)                               â”‚
â”‚   }                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“¦ à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡ Request (GeneratePdfRequest)

```json
{
  "bookNameId": "90F72F0E-528D-4992-907A-F2C6B37AD9A5",  // UUID à¸›à¸£à¸°à¹€à¸ à¸—à¹€à¸­à¸à¸ªà¸²à¸£

  "documentMain": {           // à¹€à¸­à¸à¸ªà¸²à¸£à¸«à¸¥à¸±à¸ (à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡)
    "bookName": "à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡",
    "bookTitle": "à¸‚à¸­à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´...",
    "bookNo": "à¸ªà¸à¸˜à¸­. 0102/2568",
    "dateThai": "29 à¸˜à¸±à¸™à¸§à¸²à¸„à¸¡ 2568",
    "department": "à¸ªà¸³à¸™à¸±à¸à¸‡à¸²à¸™...",
    "divisionName": "à¸à¹ˆà¸²à¸¢...",
    "speedLayer": "à¸”à¹ˆà¸§à¸™à¸—à¸µà¹ˆà¸ªà¸¸à¸”",
    "bookContent": {
      "subject": "à¸«à¸±à¸§à¸‚à¹‰à¸­",
      "content": "à¹€à¸™à¸·à¹‰à¸­à¸«à¸² (text à¸«à¸£à¸·à¸­ HTML)",
      "contentType": "text|html"
    }
  },

  "documentSub": {            // à¹€à¸­à¸à¸ªà¸²à¸£à¸£à¸­à¸‡ (à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸ªà¹ˆà¸‡à¸­à¸­à¸)
    "bookNo": "...",
    "dateThai": "...",
    "address": "à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¸ªà¸³à¸™à¸±à¸à¸‡à¸²à¸™",
    "contact": "à¹‚à¸—à¸£. ...",
    "bookContent": {...},
    "bookReferTo": [...],     // à¸­à¹‰à¸²à¸‡à¸–à¸¶à¸‡
    "attachment": [...]       // à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¸¡à¸²à¸”à¹‰à¸§à¸¢
  },

  "bookSigned": [{            // à¸œà¸¹à¹‰à¸¥à¸‡à¸™à¸²à¸¡
    "prefixName": "à¸™à¸²à¸¢",
    "firstname": "à¸ªà¸¡à¸Šà¸²à¸¢",
    "lastname": "à¹ƒà¸ˆà¸”à¸µ",
    "positionName": "à¸œà¸¹à¹‰à¸­à¸³à¸™à¸§à¸¢à¸à¸²à¸£",
    "signatureBase64": "..."
  }],

  "bookLearner": [...],       // à¸œà¸¹à¹‰à¸£à¸±à¸šà¸ à¸²à¸¢à¹ƒà¸™ (à¹€à¸£à¸µà¸¢à¸™)
  "bookSubmited": [...],      // à¸œà¸¹à¹‰à¹€à¸ªà¸™à¸­à¸œà¹ˆà¸²à¸™

  "toRecipients": [{          // à¸œà¸¹à¹‰à¸£à¸±à¸šà¸ à¸²à¸¢à¸™à¸­à¸
    "organizeName": "à¸à¸£à¸°à¸—à¸£à¸§à¸‡...",
    "salutation": "à¹€à¸£à¸µà¸¢à¸™",
    "salutationContent": "à¸—à¹ˆà¸²à¸™à¸›à¸¥à¸±à¸”...",
    "endDoc": "à¸‚à¸­à¹à¸ªà¸”à¸‡à¸„à¸§à¸²à¸¡à¸™à¸±à¸šà¸–à¸·à¸­"
  }]
}
```

---

## 3. à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡ Architecture

### ğŸ—ï¸ Design Patterns à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰

| Pattern              | à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™                                | à¹„à¸Ÿà¸¥à¹Œ                       |
| -------------------- | ---------------------------------------- | -------------------------- |
| **Factory Pattern**  | à¹€à¸¥à¸·à¸­à¸ Generator à¸•à¸²à¸¡à¸›à¸£à¸°à¹€à¸ à¸—à¹€à¸­à¸à¸ªà¸²à¸£          | `PdfGeneratorFactory.java` |
| **Strategy Pattern** | à¹à¸•à¹ˆà¸¥à¸° Generator à¹€à¸›à¹‡à¸™ Strategy            | `*PdfGenerator.java`       |
| **Template Method**  | Base class à¸à¸³à¸«à¸™à¸” flow, subclass override | `PdfGeneratorBase.java`    |
| **Builder Pattern**  | à¸ªà¸£à¹‰à¸²à¸‡ model objects                      | Lombok `@Builder`          |

### ğŸ”§ Technology Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            API Layer                        â”‚
â”‚   Spring Boot 3.x + REST Controllers        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Service Layer                     â”‚
â”‚   GeneratePdfService + Factory              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           PDF Generation Layer              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Apache PDFBox 2.x                   â”‚   â”‚
â”‚   â”‚ - PDDocument, PDPage                â”‚   â”‚
â”‚   â”‚ - PDPageContentStream               â”‚   â”‚
â”‚   â”‚ - PDType0Font (Thai support)        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ OpenHTMLtoPDF                       â”‚   â”‚
â”‚   â”‚ - HTML â†’ PDF conversion             â”‚   â”‚
â”‚   â”‚ - Table rendering                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Jsoup                               â”‚   â”‚
â”‚   â”‚ - HTML parsing                      â”‚   â”‚
â”‚   â”‚ - Text extraction                   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. à¸‚à¹‰à¸­à¸”à¸µ (Strengths)

### âœ… Architecture & Design

| à¸‚à¹‰à¸­à¸”à¸µ                          | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                                                                   |
| ------------------------------ | ---------------------------------------------------------------------------- |
| **Factory + Strategy Pattern** | à¸‡à¹ˆà¸²à¸¢à¸•à¹ˆà¸­à¸à¸²à¸£à¹€à¸à¸´à¹ˆà¸¡à¸›à¸£à¸°à¹€à¸ à¸—à¹€à¸­à¸à¸ªà¸²à¸£à¹ƒà¸«à¸¡à¹ˆ - à¸ªà¸£à¹‰à¸²à¸‡ Generator à¹ƒà¸«à¸¡à¹ˆà¹à¸¥à¸°à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¹ƒà¸™ Factory |
| **Separation of Concerns**     | à¹à¸¢à¸ Controller / Service / Generator à¸Šà¸±à¸”à¹€à¸ˆà¸™                                  |
| **Base Class**                 | Code reuse à¸ªà¸¹à¸‡ - common methods à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ `PdfGeneratorBase`                    |
| **Lombok**                     | à¸¥à¸” boilerplate code (getters, setters, builders)                             |

### âœ… PDF Generation

| à¸‚à¹‰à¸­à¸”à¸µ                           | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                         |
| ------------------------------- | ---------------------------------- |
| **Apache PDFBox (Open Source)** | à¹„à¸¡à¹ˆà¸¡à¸µà¸„à¹ˆà¸²à¸¥à¸´à¸‚à¸ªà¸´à¸—à¸˜à¸´à¹Œ (vs iText7)      |
| **Thai Font Support**           | à¸£à¸­à¸‡à¸£à¸±à¸š TH Sarabun New              |
| **Multi-page Support**          | à¸ˆà¸±à¸”à¸à¸²à¸£à¸«à¸™à¹‰à¸²à¹ƒà¸«à¸¡à¹ˆà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´            |
| **HTML Content**                | à¸£à¸­à¸‡à¸£à¸±à¸š HTML/CSS à¸œà¹ˆà¸²à¸™ OpenHTMLtoPDF |
| **Table Rendering**             | à¸¡à¸µ TableRenderer à¸ªà¸³à¸«à¸£à¸±à¸šà¸•à¸²à¸£à¸²à¸‡ HTML  |

### âœ… API Design

| à¸‚à¹‰à¸­à¸”à¸µ                | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                         |
| -------------------- | ---------------------------------- |
| **RESTful API**      | Standard HTTP endpoints            |
| **Generic Response** | `ApiResponse<T>` wrapper           |
| **Health Check**     | `/api/pdf/health` endpoint         |
| **Book Types Info**  | `/api/pdf/book-types` endpoint     |
| **View Endpoint**    | `/api/pdf/view` à¸ªà¸³à¸«à¸£à¸±à¸š dev testing |

---

## 5. à¸‚à¹‰à¸­à¹€à¸ªà¸µà¸¢ (Weaknesses)

### âš ï¸ Code Quality Issues

| à¸›à¸±à¸à¸«à¸²                   | à¹„à¸Ÿà¸¥à¹Œ                      | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                                    |
| ----------------------- | ------------------------- | --------------------------------------------- |
| **God Class**           | `PdfGeneratorBase.java`   | **1,774 à¸šà¸£à¸£à¸—à¸±à¸”!** à¹ƒà¸«à¸à¹ˆà¹€à¸à¸´à¸™à¹„à¸› à¸„à¸§à¸£à¹à¸¢à¸           |
| **Large Request Model** | `GeneratePdfRequest.java` | 349 à¸šà¸£à¸£à¸—à¸±à¸” - à¸¡à¸µ nested classes à¸¡à¸²à¸à¹€à¸à¸´à¸™à¹„à¸›      |
| **Hardcoded Values**    | à¸«à¸¥à¸²à¸¢à¹„à¸Ÿà¸¥à¹Œ                  | Margins, font sizes, colors hardcoded         |
| **TODO Comments**       | à¸«à¸¥à¸²à¸¢à¸—à¸µà¹ˆ                   | à¸¡à¸µ `// TODO: implement if needed` à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹€à¸ªà¸£à¹‡à¸ˆ |

### âš ï¸ Inconsistency Issues

```java
// à¸›à¸±à¸à¸«à¸²: Helper methods à¸„à¸·à¸™à¸„à¹ˆà¸²à¹„à¸¡à¹ˆà¸ªà¸¡à¹ˆà¸³à¹€à¸ªà¸¡à¸­
public BookSubDetail getSubDetail() {
    return null; // TODO: implement if needed
}

public String getRecipients() {
    return null; // Not used in new format
}

public String getEndDoc() {
    return null; // Get from toRecipients instead
}
```

### âš ï¸ Error Handling

| à¸›à¸±à¸à¸«à¸²                   | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                              |
| ----------------------- | --------------------------------------- |
| **Generic Exception**   | `catch (Exception e)` à¹ƒà¸Šà¹‰à¸šà¹ˆà¸­à¸¢à¹€à¸à¸´à¸™à¹„à¸›     |
| **Warning Suppression** | `@SuppressWarnings("unused")` à¸‹à¹ˆà¸­à¸™à¸›à¸±à¸à¸«à¸² |
| **Missing Validation**  | à¹„à¸¡à¹ˆà¸¡à¸µ input validation à¸—à¸µà¹ˆ controller   |

### âš ï¸ Configuration Issues

```java
// SecurityConfig.java - à¸›à¸´à¸” Security à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”!
.authorizeHttpRequests(auth -> auth
    .anyRequest().permitAll() // à¸­à¸™à¸¸à¸à¸²à¸•à¸—à¸¸à¸ request (à¸ªà¸³à¸«à¸£à¸±à¸š development)
);
```

---

## 6. à¸Šà¹ˆà¸­à¸‡à¹‚à¸«à¸§à¹ˆà¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡ (Vulnerabilities)

### ğŸ”´ Critical Security Issues

| à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡            | à¸£à¸°à¸”à¸±à¸š       | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                                | à¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚           |
| --------------------- | ----------- | ----------------------------------------- | ------------------ |
| **No Authentication** | ğŸ”´ Critical | à¸›à¸´à¸” Security à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” - à¹ƒà¸„à¸£à¸à¹‡à¹€à¸£à¸µà¸¢à¸ API à¹„à¸”à¹‰ | à¹€à¸à¸´à¹ˆà¸¡ JWT/OAuth2   |
| **CSRF Disabled**     | ğŸŸ  High     | `csrf.disable()` à¹€à¸›à¸´à¸”à¹‚à¸­à¸à¸²à¸ªà¹ƒà¸«à¹‰à¹‚à¸ˆà¸¡à¸•à¸µ        | à¹ƒà¸Šà¹‰ CSRF token     |
| **CORS Allow All**    | ğŸŸ  High     | `@CrossOrigin(origins = "*")`             | à¸ˆà¸³à¸à¸±à¸” origins      |
| **No Rate Limiting**  | ğŸŸ  High     | à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¸ˆà¸³à¸à¸±à¸” request - DoS attack à¹„à¸”à¹‰    | à¹€à¸à¸´à¹ˆà¸¡ rate limiter |

### ğŸŸ  Data Security Issues

| à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡                 | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                             | à¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚            |
| -------------------------- | -------------------------------------- | ------------------- |
| **Base64 Signature**       | à¸¥à¸²à¸¢à¹€à¸‹à¹‡à¸™à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ request à¹„à¸¡à¹ˆà¸¡à¸µ encryption | à¹€à¸‚à¹‰à¸²à¸£à¸«à¸±à¸ªà¸¥à¸²à¸¢à¹€à¸‹à¹‡à¸™     |
| **No Input Sanitization**  | HTML content à¹„à¸¡à¹ˆà¸¡à¸µ sanitize            | à¹ƒà¸Šà¹‰ HTML sanitizer  |
| **Logging Sensitive Data** | à¸­à¸²à¸ˆ log à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸³à¸„à¸±à¸                    | Mask sensitive data |

### ğŸŸ¡ Operational Issues

| à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡             | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                                 | à¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚                       |
| ---------------------- | ------------------------------------------ | ------------------------------ |
| **No Timeout**         | PDF generation à¹„à¸¡à¹ˆà¸¡à¸µ timeout               | à¹€à¸à¸´à¹ˆà¸¡ timeout config           |
| **Memory Usage**       | `MemoryUsageSetting.setupMainMemoryOnly()` | à¹ƒà¸Šà¹‰ temp files à¸ªà¸³à¸«à¸£à¸±à¸š PDF à¹ƒà¸«à¸à¹ˆ |
| **No File Size Limit** | à¹„à¸¡à¹ˆà¸ˆà¸³à¸à¸±à¸”à¸‚à¸™à¸²à¸” input                         | à¹€à¸à¸´à¹ˆà¸¡ validation               |

---

## 7. à¸›à¸±à¸à¸«à¸²à¸—à¸µà¹ˆà¸­à¸²à¸ˆà¸à¸šà¹ƒà¸™à¸à¸²à¸£à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸­à¸à¸ªà¸²à¸£

### ğŸ› à¸›à¸±à¸à¸«à¸²à¸—à¸µà¹ˆà¸™à¹ˆà¸²à¸ˆà¸°à¹€à¸ˆà¸­

#### 7.1 HTML Content Rendering Issues

```java
// à¸›à¸±à¸à¸«à¸²: contentType à¸­à¸²à¸ˆà¹„à¸¡à¹ˆà¸•à¸£à¸‡à¸à¸±à¸šà¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¸ˆà¸£à¸´à¸‡
public boolean isHtmlContent() {
    return "html".equalsIgnoreCase(contentType);
}

// à¸–à¹‰à¸² contentType = "text" à¹à¸•à¹ˆà¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¸¡à¸µ HTML tags â†’ render à¸œà¸´à¸”
// à¸–à¹‰à¸² contentType = "html" à¹à¸•à¹ˆà¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¹€à¸›à¹‡à¸™ plain text â†’ à¸à¹‡à¸¢à¸±à¸‡à¸—à¸³à¸‡à¸²à¸™à¹„à¸”à¹‰
```

**à¸ªà¸²à¹€à¸«à¸•à¸¸:** à¸£à¸°à¸šà¸šà¹€à¸Šà¹‡à¸„ `contentType` à¸à¹ˆà¸­à¸™ à¹à¸¥à¹‰à¸§à¸„à¹ˆà¸­à¸¢à¹€à¸Šà¹‡à¸„ `HtmlUtils.isHtml(content)` â†’ à¸­à¸²à¸ˆà¸‹à¹‰à¸³à¸‹à¹‰à¸­à¸™

#### 7.2 Multi-page Calculation Issues

```java
// PdfGeneratorBase.java
protected static final float MIN_Y_POSITION = MARGIN_BOTTOM + 100;

// à¸›à¸±à¸à¸«à¸²: à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¸§à¹ˆà¸²à¹€à¸™à¸·à¹‰à¸­à¸«à¸²à¸ˆà¸°à¸¥à¹‰à¸™à¸«à¸™à¹‰à¸²à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆà¸­à¸²à¸ˆà¹„à¸¡à¹ˆà¹à¸¡à¹ˆà¸™à¸¢à¸³
// à¹€à¸à¸£à¸²à¸°à¸•à¹‰à¸­à¸‡à¸„à¸³à¸™à¸§à¸“à¸„à¸§à¸²à¸¡à¸ªà¸¹à¸‡à¸‚à¸­à¸‡ HTML content à¸à¹ˆà¸­à¸™à¸§à¸²à¸”
```

#### 7.3 Font Width Calculation

```java
// à¸›à¸±à¸à¸«à¸²: Thai text width calculation à¸­à¸²à¸ˆà¹„à¸¡à¹ˆà¹à¸¡à¹ˆà¸™à¸¢à¸³
float textWidth = font.getStringWidth(text) / 1000 * fontSize;

// Thai characters à¸¡à¸µ width à¹„à¸¡à¹ˆà¹€à¸—à¹ˆà¸²à¸à¸±à¸™ à¹à¸¥à¸°à¸¡à¸µ vowel marks à¸—à¸µà¹ˆà¸‹à¹‰à¸­à¸™à¸à¸±à¸™
```

#### 7.4 Table Column Width

```java
// TableRenderer.java
// à¸„à¸³à¸™à¸§à¸“à¸„à¸§à¸²à¸¡à¸à¸§à¹‰à¸²à¸‡à¹à¸šà¸šà¹€à¸—à¹ˆà¸²à¹† à¸à¸±à¸™ - à¹„à¸¡à¹ˆà¸¢à¸·à¸”à¸«à¸¢à¸¸à¹ˆà¸™
float colWidth = maxWidth / maxCols;
for (int i = 0; i < maxCols; i++) {
    columnWidths.add(colWidth);
}
```

#### 7.5 Speed Layer Position

```java
// à¸›à¸±à¸à¸«à¸²: Speed Layer à¸­à¸²à¸ˆà¸—à¸±à¸šà¸à¸±à¸š Logo à¹ƒà¸™à¸šà¸²à¸‡à¸à¸£à¸“à¸µ
if (logoPosition == LogoPosition.RIGHT) {
    float logoOffset = LOGO_WIDTH + 10;
    textX = PAGE_WIDTH - MARGIN_RIGHT - textWidth - logoOffset;
}
// à¸–à¹‰à¸² speedLayer à¸¢à¸²à¸§à¸¡à¸²à¸ à¸­à¸²à¸ˆà¸¥à¹‰à¸™à¸­à¸­à¸à¸™à¸­à¸à¸«à¸™à¹‰à¸²
```

#### 7.6 Signature Box Overlap

```java
// à¸›à¸±à¸à¸«à¸²: à¸Šà¹ˆà¸­à¸‡à¸¥à¸‡à¸™à¸²à¸¡à¸«à¸¥à¸²à¸¢à¸„à¸™à¸­à¸²à¸ˆà¸‹à¹‰à¸­à¸™à¸à¸±à¸™
float boxX = PAGE_WIDTH / 2 + 20;  // à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡ fixed
// à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¹€à¸Šà¹‡à¸„à¸§à¹ˆà¸²à¸ˆà¸°à¸Šà¸™à¸à¸±à¸š element à¸­à¸·à¹ˆà¸™à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ
```

### ğŸ” à¸§à¸´à¸˜à¸µà¸à¸²à¸£ Debug

```java
// à¹€à¸›à¸´à¸” debug borders
protected static final boolean ENABLE_DEBUG_BORDERS = true; // à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹€à¸›à¹‡à¸™ true

// à¸ˆà¸°à¹€à¸«à¹‡à¸™ margins à¹à¸¥à¸° content area à¸Šà¸±à¸”à¹€à¸ˆà¸™
```

---

## 8. à¸‚à¹‰à¸­à¹€à¸ªà¸™à¸­à¹à¸™à¸°à¸à¸²à¸£à¸à¸±à¸’à¸™à¸²

### ğŸ“Œ Phase 1: Critical Fixes (à¸„à¸§à¸£à¸—à¸³à¸—à¸±à¸™à¸—à¸µ)

| à¸¥à¸³à¸”à¸±à¸š | à¸‡à¸²à¸™                        | à¸„à¸§à¸²à¸¡à¸ªà¸³à¸„à¸±à¸   | à¸›à¸£à¸°à¸¡à¸²à¸“à¹€à¸§à¸¥à¸² |
| ----- | -------------------------- | ----------- | ---------- |
| 1.1   | à¹€à¸à¸´à¹ˆà¸¡ Authentication (JWT) | ğŸ”´ Critical | 2-3 à¸§à¸±à¸™    |
| 1.2   | à¸ˆà¸³à¸à¸±à¸” CORS origins         | ğŸ”´ Critical | 1 à¸Šà¸¡.      |
| 1.3   | à¹€à¸à¸´à¹ˆà¸¡ Input Validation     | ğŸŸ  High     | 1 à¸§à¸±à¸™      |
| 1.4   | à¹€à¸à¸´à¹ˆà¸¡ Rate Limiting        | ğŸŸ  High     | 0.5 à¸§à¸±à¸™    |

### ğŸ“Œ Phase 2: Code Quality (à¸£à¸°à¸¢à¸°à¸ªà¸±à¹‰à¸™ 1-2 à¸ªà¸±à¸›à¸”à¸²à¸«à¹Œ)

| à¸¥à¸³à¸”à¸±à¸š | à¸‡à¸²à¸™                         | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                                                                  |
| ----- | --------------------------- | --------------------------------------------------------------------------- |
| 2.1   | **à¹à¸¢à¸ PdfGeneratorBase**    | à¹à¸šà¹ˆà¸‡à¹€à¸›à¹‡à¸™: `FontManager`, `PageManager`, `DrawingUtils`, `SignatureRenderer` |
| 2.2   | **à¸ªà¸£à¹‰à¸²à¸‡ Config Class**      | à¸¢à¹‰à¸²à¸¢ hardcoded values à¹„à¸› application.properties                             |
| 2.3   | **à¹€à¸à¸´à¹ˆà¸¡ Unit Tests**        | à¸—à¸”à¸ªà¸­à¸šà¹à¸•à¹ˆà¸¥à¸° Generator à¹à¸¢à¸à¸à¸±à¸™                                                 |
| 2.4   | **à¸›à¸£à¸±à¸š Exception Handling** | à¸ªà¸£à¹‰à¸²à¸‡ custom exceptions                                                     |

#### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¹à¸¢à¸ Code

```java
// à¸à¹ˆà¸­à¸™: PdfGeneratorBase (1,774 lines)
// à¸«à¸¥à¸±à¸‡: à¹à¸¢à¸à¹€à¸›à¹‡à¸™ components

// FontManager.java
public class FontManager {
    public PDFont loadThaiFont(PDDocument document) { ... }
    public PDFont loadBoldFont(PDDocument document) { ... }
}

// PageManager.java
public class PageManager {
    public PDPage createNewPage(PDDocument document) { ... }
    public void drawPageNumber(PDPageContentStream stream) { ... }
}

// DrawingUtils.java
public class DrawingUtils {
    public float drawText(...) { ... }
    public float drawCenteredText(...) { ... }
    public float drawMultilineText(...) { ... }
}

// SignatureRenderer.java
public class SignatureRenderer {
    public float drawSignerBox(...) { ... }
    public float drawSignatureWithImage(...) { ... }
}
```

### ğŸ“Œ Phase 3: Features (à¸£à¸°à¸¢à¸°à¸à¸¥à¸²à¸‡)

| à¸¥à¸³à¸”à¸±à¸š | à¸‡à¸²à¸™                      | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                        |
| ----- | ------------------------ | --------------------------------- |
| 3.1   | **Async PDF Generation** | à¹ƒà¸Šà¹‰ `@Async` à¸ªà¸³à¸«à¸£à¸±à¸š PDF à¸‚à¸™à¸²à¸”à¹ƒà¸«à¸à¹ˆ  |
| 3.2   | **PDF Caching**          | Cache PDF à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¸‹à¹‰à¸³à¸šà¹ˆà¸­à¸¢         |
| 3.3   | **Batch Generation**     | à¸ªà¸£à¹‰à¸²à¸‡à¸«à¸¥à¸²à¸¢ PDF à¸à¸£à¹‰à¸­à¸¡à¸à¸±à¸™            |
| 3.4   | **Template System**      | à¹ƒà¸Šà¹‰ template à¹à¸—à¸™ hardcoded layout |

### ğŸ“Œ Phase 4: Architecture (à¸£à¸°à¸¢à¸°à¸¢à¸²à¸§)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Future Architecture                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   API        â”‚    â”‚   Queue      â”‚    â”‚   Worker     â”‚  â”‚
â”‚  â”‚   Gateway    â”‚â”€â”€â”€â–¶â”‚   (Redis)    â”‚â”€â”€â”€â–¶â”‚   Service    â”‚  â”‚
â”‚  â”‚              â”‚    â”‚              â”‚    â”‚              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Template   â”‚    â”‚   Font       â”‚    â”‚   Storage    â”‚  â”‚
â”‚  â”‚   Service    â”‚    â”‚   Service    â”‚    â”‚   (S3/Minio) â”‚  â”‚
â”‚  â”‚              â”‚    â”‚              â”‚    â”‚              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. à¹à¸œà¸™à¸à¸²à¸£à¸”à¸¹à¹à¸¥à¸£à¸±à¸à¸©à¸²

### ğŸ“… Daily Maintenance

| à¸‡à¸²à¸™           | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                 |
| ------------- | -------------------------- |
| Monitor Logs  | à¸”à¸¹ error logs à¹ƒà¸™ container |
| Check Health  | `GET /api/pdf/health`      |
| Docker Status | `docker ps`, `docker logs` |

### ğŸ“… Weekly Maintenance

| à¸‡à¸²à¸™                   | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                     |
| --------------------- | ------------------------------ |
| Review Error Patterns | à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ errors à¸—à¸µà¹ˆà¹€à¸à¸´à¸”à¸šà¹ˆà¸­à¸¢   |
| Performance Check     | à¸”à¸¹ response time, memory usage |
| Dependency Updates    | à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š vulnerability alerts   |

### ğŸ“… Monthly Maintenance

| à¸‡à¸²à¸™                  | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”                 |
| -------------------- | -------------------------- |
| Code Review          | Review à¹à¸¥à¸° refactor code   |
| Documentation Update | à¸­à¸±à¸à¹€à¸”à¸— API docs            |
| Security Scan        | à¹ƒà¸Šà¹‰ OWASP Dependency Check |

### ğŸ”§ Monitoring Checklist

```bash
# Health Check
curl http://localhost:8888/api/pdf/health

# Container Logs
docker logs sarabun-pdf-api --tail 100

# Container Stats
docker stats sarabun-pdf-api

# Test PDF Generation
curl -X POST http://localhost:8888/api/pdf/preview \
  -H "Content-Type: application/json" \
  -d @test-request.json
```

### ğŸ“Š Key Metrics to Track

| Metric        | Target  | Alert Threshold |
| ------------- | ------- | --------------- |
| Response Time | < 3s    | > 10s           |
| Error Rate    | < 1%    | > 5%            |
| Memory Usage  | < 512MB | > 1GB           |
| CPU Usage     | < 50%   | > 80%           |

---

## ğŸ“ à¸ªà¸£à¸¸à¸›

### à¸ˆà¸¸à¸”à¹à¸‚à¹‡à¸‡à¸«à¸¥à¸±à¸

1. Architecture à¸”à¸µ (Factory + Strategy Pattern)
2. à¸£à¸­à¸‡à¸£à¸±à¸š 9 à¸›à¸£à¸°à¹€à¸ à¸—à¹€à¸­à¸à¸ªà¸²à¸£
3. Open Source (PDFBox) à¹„à¸¡à¹ˆà¸¡à¸µà¸„à¹ˆà¸²à¸¥à¸´à¸‚à¸ªà¸´à¸—à¸˜à¸´à¹Œ

### à¸ˆà¸¸à¸”à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡à¹€à¸£à¹ˆà¸‡à¸”à¹ˆà¸§à¸™

1. **Security** - à¹€à¸à¸´à¹ˆà¸¡ Authentication à¸à¹ˆà¸­à¸™ production
2. **Code Quality** - à¹à¸¢à¸ God Class (PdfGeneratorBase)
3. **Validation** - à¹€à¸à¸´à¹ˆà¸¡ input validation

### à¸›à¸±à¸à¸«à¸²à¸—à¸µà¹ˆà¸™à¹ˆà¸²à¸ˆà¸°à¹€à¸ˆà¸­à¹ƒà¸™à¸à¸²à¸£à¸ªà¸£à¹‰à¸²à¸‡à¹€à¸­à¸à¸ªà¸²à¸£

1. HTML/Table rendering à¹„à¸¡à¹ˆà¸•à¸£à¸‡à¸•à¸²à¸¡à¸•à¹‰à¸­à¸‡à¸à¸²à¸£
2. Multi-page calculation à¹„à¸¡à¹ˆà¹à¸¡à¹ˆà¸™à¸¢à¸³
3. Thai font width calculation
4. Signature box positioning

---

**à¹€à¸‚à¸µà¸¢à¸™à¹‚à¸”à¸¢:** GitHub Copilot (Claude Opus 4.5)  
**à¸§à¸±à¸™à¸—à¸µà¹ˆ:** 14 à¸¡à¸à¸£à¸²à¸„à¸¡ 2569
